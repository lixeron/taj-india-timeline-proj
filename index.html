<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Taj India Timeline (1986â€“Present)</title>
  <link href="https://fonts.googleapis.com/css2?family=Tiro+Devanagari+Sanskrit:ital@0;1&family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <style>
    /* Animated saffron "steam" along sides */
    .steam {
      position: fixed;
      top: 0;
      bottom: 0;
      width: 220px;               /* slightly wider, but we hide overflow-x */
      z-index: 1;                 /* between bg (0) and content (2) */
      pointer-events: none;
      overflow: hidden;
      filter: blur(36px) saturate(112%);
      opacity: .55;
    }
    .steam.left { left: 0; }
    .steam.right { right: 0; }

    .steam::before,
    .steam::after{
      content: "";
      position: absolute; left: 50%;
      width: 260px; height: 380px;
      border-radius: 50%;
      transform: translateX(-50%) translateY(100%);
      background: radial-gradient(closest-side, rgba(255,122,0,.32), rgba(255,122,0,0) 70%),
                  radial-gradient(closest-side, rgba(207,162,74,.26), rgba(207,162,74,0) 70%);
      opacity: .75;
      animation: wisp 10s ease-in-out infinite;
    }
    .steam::after{
      width: 300px; height: 420px;
      background: radial-gradient(closest-side, rgba(255,170,60,.28), rgba(255,170,60,0) 70%),
                  radial-gradient(closest-side, rgba(207,162,74,.20), rgba(207,162,74,0) 70%);
      opacity: .6;
      animation: wisp2 13s ease-in-out infinite;
      animation-delay: 2.2s;
    }
    .steam.left::before  { animation-delay: .0s; }
    .steam.left::after   { animation-delay: 2.2s; }
    .steam.right::before { animation-delay: 1.1s; }
    .steam.right::after  { animation-delay: 3.1s; }

    @keyframes wisp{
      0%   { transform: translateX(-50%) translateY(100%) scale(0.95); opacity:.10; }
      30%  { transform: translateX(-45%) translateY(45%)  scale(1.00); opacity:.35; }
      60%  { transform: translateX(-55%) translateY(10%)  scale(1.06); opacity:.55; }
      100% { transform: translateX(-50%) translateY(-40%) scale(1.00); opacity:.00; }
    }
    @keyframes wisp2{
      0%   { transform: translateX(-50%) translateY(100%) scale(0.92); opacity:.05; }
      35%  { transform: translateX(-53%) translateY(50%)  scale(1.02); opacity:.30; }
      70%  { transform: translateX(-47%) translateY(15%)  scale(1.07); opacity:.50; }
      100% { transform: translateX(-50%) translateY(-35%) scale(1.00); opacity:.00; }
    }

    /* Indian-style headings */
    h1, h2, h3 {
      font-family: "Tiro Devanagari Sanskrit", serif;
      letter-spacing: .3px;
      color: #6b4000;
    }

    header h1 { color: #ffffff; font-family: "Tiro Devanagari Sanskrit", serif; font-weight: 900; }

    /* Global Variables */
    :root{ 
      --bg:#0b0b0e;
      --card:#af7408;
      --accent:#ff7a00; 
      --text:#d6bc29; 
    }
    *{ box-sizing:border-box; }

    html, body { height: 100%; max-width: 100%; overflow-x: hidden; }
    body{
      margin:0;
      color:#1c1c1c;
      font: 16px/1.6 "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;

      /* Warm Taj-India inspired gradient background */
      background-color: #ccbe7f;
      background-image:
        radial-gradient(circle at top left, rgba(255,122,0,0.16), transparent 60%),
        radial-gradient(circle at bottom right, rgba(19,136,8,0.16), transparent 60%);
    }

    /* Top orange title bar */
    header {
      position: sticky;
      top: 0;
      z-index: 10;
      background: var(--accent);
      padding: 10px 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      text-align: center;
      border-bottom: 3px solid #cfa24a;
      animation: goldPulse 3.2s ease-in-out infinite;
    }
    header::after {
      content: "";
      position: absolute; inset: 0;
      background: radial-gradient(circle at center, rgba(255,255,255,0.25) 0%, transparent 70%);
      animation: headerGlow 4s ease-in-out infinite alternate;
      pointer-events: none;
    }
    @keyframes headerGlow {
      0% { opacity: 0.4; transform: scale(1.0); }
      100% { opacity: 0.8; transform: scale(1.2); }
    }
    @keyframes goldPulse { 
      0%,100% { text-shadow: 0 0 4px rgba(207,162,74,.55), 0 0 10px rgba(207,162,74,.35); }
      50%     { text-shadow: 0 0 6px rgba(207,162,74,.75), 0 0 14px rgba(207,162,74,.45); }
    }
    header h1 {
      margin: 0;
      font-size: clamp(22px, 2.8vw, 28px);
      letter-spacing: .5px;
      color: #fff;
      font-weight: 900;
    }

    /* Main container + sticky footer layout */
    body { min-height: 100vh; display: flex; flex-direction: column; }
    main { flex: 1; }

    .container{ 
      max-width:2000px; 
      margin:0 auto; 
      padding:24px 20px; 
    }

    /* Timeline layout */
    .timeline{ margin-top:60px; position:relative; }
    .event{ display:flex; align-items:flex-start; margin-bottom:80px; gap:24px; }
    .date{ flex:0 0 130px; font-weight:900; font-size:40px; color:var(--accent); }
    .content{
      flex:1; background:var(--card); padding:20px; border-radius:12px;
      box-shadow:0 4px 16px rgba(0,0,0,.3);
      display:flex; align-items:center; gap:18px;
      border:1px solid rgba(207,162,74,.18);
    }
    .content img{
      width:220px; height:150px; object-fit:cover; border-radius:12px; flex-shrink:0;
      border:1px solid rgba(207,162,74,.35);
      box-shadow:0 6px 20px rgba(0,0,0,.35);
    }
    .text-block{ flex:1; }
    .text-block h2 {
      margin: 0 0 6px 0;
      font-size: 20px;
      font-weight: 700;
      font-family: "Tiro Devanagari Sanskrit", serif;
      color: #145a32;
      text-shadow:
        -1px -1px 0 #cfa24a,
         1px -1px 0 #cfa24a,
        -1px  1px 0 #cfa24a,
         1px  1px 0 #cfa24a;
    }

    /* Fade-in animation */
    .reveal{ opacity:0; transform:translateY(16px);
             transition:opacity 2.0s ease, transform 2.0s ease; }
    .reveal.show{ opacity:1; transform:none; }

    /* Mobile */
    @media (max-width:640px){
      .event{ flex-direction:column; }
      .content{ flex-direction:column; }
      .content img{ width:100%; height:auto; }
    }

    /* --- Dot rail --- */
    .timeline-nav { margin-top:24px; }
    .timeline-nav .rail{
      position:relative;
      display:flex; justify-content:space-between; align-items:center;
      padding:18px 6px;
      background: linear-gradient(0deg, rgba(255,122,0,.12), rgba(255,122,0,.12));
      border:1px solid rgba(255,122,0,.25);
      border-radius:999px;
    }
    .timeline-nav .rail::before{
      content:""; position:absolute; left:24px; right:24px; top:50%;
      height:2px; background:rgba(255,122,0,.45); transform:translateY(-50%);
    }

    .dot{
      position:relative;
      width:18px; height:18px; border-radius:50%;
      background:#ffd813; border:2px solid #fff;
      box-shadow:0 0 0 2px rgba(255,122,0,.35);
      cursor:pointer;
      transition: transform .15s ease, box-shadow .2s ease;
    }
    .dot:hover{ transform:scale(1.08); box-shadow:0 0 0 4px rgba(255,122,0,.28); }
    .dot.active{ background:#cfa24a; box-shadow:0 0 0 4px rgba(207,162,74,.35); }
    .dot::after{
      content: attr(data-label);
      position:absolute; left:50%; top:-34px; transform:translateX(-50%);
      background:#14161a; color:#fff; padding:4px 8px; border-radius:8px;
      font-size:12px; white-space:nowrap; opacity:0; pointer-events:none;
      border:1px solid rgba(255,255,255,.12);
      transition: opacity .15s ease, transform .15s ease;
    }
    .dot:hover::after{ opacity:1; transform:translateX(-50%) translateY(-2px); }

    /* Viewer */
    #viewer{ margin-top:28px; }
    .viewer-date{
      color:#ff7a00; font-weight:900; font-size:20px; margin:0 0 10px 4px;
      font-family:"Tiro Devanagari Sanskrit", serif;
    }
    .viewer-card{ 
      position:relative; 
      overflow:hidden;
      background: linear-gradient(145deg, #a98e16 0%, #c5b119 100%);
      border: 1px solid rgba(207,162,74,0.25);
      border-radius: 12px;
      display:flex;
      align-items:center;
      gap:18px;
      padding:20px;
      width: 100%;          /* make it stretch across the container */
    }
    .viewer-card.fade-out{ opacity:0; transform:translateY(8px); transition:opacity .25s ease, transform .25s ease; }
    .viewer-card.fade-in{ opacity:1; transform:none; transition:opacity .35s ease, transform .35s ease; }

    .viewer-img{
      width:220px; height:150px; object-fit:contain;
      border-radius:12px; border:1px solid rgba(207,162,74,.35);
      box-shadow:0 6px 20px rgba(0,0,0,.35); flex-shrink:0; margin-right:18px;
    }
    @media (max-width:640px){
      .viewer-img{ width:100%; height:auto; margin-right:0; }
      .viewer-card{ flex-direction: column; }
    }

    .viewer-img,
    .content img{
      width: 220px;
      height: 150px;   /* fixed frame */
      object-fit: cover;  /* fills, will crop if ratios differ */
    }
    /* ===== Intro Overlay ===== */
    #intro{
      position: fixed; inset: 0; z-index: 9999;
      background: radial-gradient(1200px 800px at 50% 50%, #101218 0%, #0b0b0e 60%, #06070a 100%);
      display: grid; place-items: center; overflow: hidden;
      transition: opacity .7s ease, transform .7s ease;
    }
    #intro.hide{ opacity: 0; transform: scale(1.03); pointer-events: none; }
    #intro .intro-content{ position: relative; text-align: center; color: var(--text); padding: 24px 28px; z-index: 2; }
    #intro .intro-content h1{ margin: 0 0 10px 0; font-size: clamp(28px, 6vw, 56px); font-weight: 900; letter-spacing: .5px; }
    #intro .byline{ margin: 0; opacity: .85; font-size: clamp(14px, 2.5vw, 18px); }
    #intro .hint{ margin-top: 12px; opacity: .6; font-size: 14px; }
    #intro .intro-bg{
      position: absolute; inset: 0; z-index: 1;
      background:
        radial-gradient(3px 3px at 20% 30%, rgba(255,255,255,.45) 0 40%, transparent 41%) repeat,
        radial-gradient(3px 3px at 70% 60%, rgba(255,255,255,.38) 0 40%, transparent 41%) repeat,
        radial-gradient(2.5px 2.5px at 40% 80%, rgba(255,255,255,.35) 0 40%, transparent 41%) repeat,
        radial-gradient(2.5px 2.5px at 85% 20%, rgba(255,255,255,.42) 0 40%, transparent 41%) repeat;
      background-size: 300px 300px, 380px 380px, 260px 260px, 420px 420px;
      animation: drift1 16s linear infinite, drift2 28s linear infinite reverse;
      filter: drop-shadow(0 0 3px rgba(255,255,255,.4));
      opacity: .99;
    }
    @keyframes drift1{
      0%   { background-position: 0 0, 0 0, 0 0, 0 0; }
      100% { background-position: 300px 240px, -280px -210px, 220px -200px, -300px 260px; }
    }
    @keyframes drift2{ 0% { transform: scale(1); } 100% { transform: scale(1.04); } }

    /* Keep the long list hidden since youâ€™re using the viewer */
    .timeline { display:none; }

    /* Decorative frame strip above footer */
    .decor-frame {
      position: absolute;
      left: 0;
      width: 100%;
      height: 90px;
      background-repeat: repeat-x;
      background-size: contain;
      opacity: 0.9;
      filter: brightness(1.1) sepia(1) hue-rotate(15deg) saturate(3) drop-shadow(0 2px 4px rgba(0,0,0,0.3));
      pointer-events: none;
      z-index: -1; /* behind content */
      animation: shimmer 6s ease-in-out infinite;
    }
    .decor-frame.bottom {
      bottom: 70px; /* sits just above footer */
      background-image: url("images/frame-bottom.png");
      transform: rotate(180deg);
    }
    @keyframes shimmer {
      0%,100% { filter: drop-shadow(0 3px 5px rgba(0,0,0,0.25)) brightness(1); }
      50% { filter: drop-shadow(0 3px 5px rgba(0,0,0,0.25)) brightness(1.2); }
    }

    /* Particles layer (under content, above bg) */
    #particles{
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 1;
      opacity: .9;
    }

    /* Diya */
    .diyaa{
      position: fixed; right: 16px; bottom: 14px; z-index: 2;
      font-size: 24px; filter: drop-shadow(0 2px 6px rgba(0,0,0,.35));
      animation: diya-flicker 1.3s ease-in-out infinite;
      user-select: none; pointer-events: none;
    }
    @keyframes diya-flicker{
      0%,100% { transform: translateY(0);   opacity: .85; }
      50%     { transform: translateY(-1px); opacity: 1;  }
    }

    /* Footer */
    footer{
      position: relative;
      width: 100%;
      background: linear-gradient(90deg, #146b3a, #0e4a27);
      color:#fffdf5;
      text-align:center;
      padding: 12px 0;
      border-top: 3px solid #cfa24a;
      font: 14px/1.3 "Poppins", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      z-index: 2;
    }
    footer p{ margin:0; }

    /* === ENLARGE VIEWER CARD === */
    .viewer-card {
      padding: 38px;
      border-radius: 20px;
      gap: 28px;
      transform: scale(1.02);
    }

    /* === BIGGER IMAGE === */
    .viewer-img {
      width: auto;
      height: auto;
      max-height: 240px;
      object-fit: contain;
      border-radius: 18px;
      padding: 12px;
      background: rgba(255,255,255,0.6);
    }

    /* === BIGGER TEXT BLOCK === */
    .viewer-title {
      font-size: 24px !important;
      line-height: 1.3;
    }

    .viewer-desc {
      font-size: 19px !important;
      line-height: 1.55;
      margin-top: 8px;
      max-width: 800px;
    }

    /* === DATE SIZE BOOST === */
    .viewer-date {
      font-size: 28px !important;
      margin-left: 4px;
    }

    /* === MOBILE IMPROVEMENTS === */
    @media (max-width: 640px) {
      .viewer-card {
        flex-direction: column;
        padding: 28px;
        gap: 22px;
      }

      .viewer-img {
        width: 100%;
        max-height: 240px;
      }

      .viewer-title {
        font-size: 24px !important;
      }
      
      .viewer-desc {
        font-size: 17px !important;
      }
    }


    /* --- viewer media / slider --- */
    .viewer-media {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .viewer-img {
      display: block;
    }

    /* arrow buttons */
    .viewer-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      border: none;
      width: 26px;
      height: 26px;
      border-radius: 50%;
      background: rgba(0,0,0,0.45);
      color: #fff;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      padding: 0;
    }

    .viewer-nav-prev { left: 6px; }
    .viewer-nav-next { right: 6px; }

    @media (max-width: 640px) {
      .viewer-media {
        width: 100%;
      }
    }

    /* === Lightbox (expanded image) === */
    .lightbox {
      position: fixed;
      inset: 0;
      display: none;          /* shown via .show */
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }

    .lightbox.show {
      display: flex;
    }

    .lightbox-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.75);
    }

    .lightbox-content {
      position: relative;
      z-index: 1;
      max-width: min(800px, 80vw);  /* was 90vw */
      max-height: 70vh;             /* was 90vh */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .lightbox-img {
      max-width: 100%;
      max-height: 100%;
      border-radius: 18px;
      background: #fff;
      padding: 8px;
      box-shadow: 0 12px 40px rgba(0,0,0,0.7);
    }

    /* close button */
    .lightbox-close {
      position: absolute;
      top: -32px;
      right: -32px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: none;
      background: #fff;
      color: #333;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(0,0,0,0.4);
    }

    /* nav arrows inside lightbox */
    .lightbox-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: none;
      background: rgba(0,0,0,0.6);
      color: #fff;
      font-size: 26px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .lightbox-prev { left: -50px; }
    .lightbox-next { right: -50px; }

    @media (max-width: 640px) {
      .lightbox-prev { left: 8px; }
      .lightbox-next { right: 8px; }
      .lightbox-close {
        top: 8px;
        right: 8px;
      }
    }
  </style>
</head>

<body>
  <!-- Intro Overlay -->
  <div id="intro" aria-hidden="true">
    <div class="intro-bg"></div>
    <div class="intro-content">
      <h1>Taj India Timeline Project</h1>
      <p class="byline">By Ethan Tran, Elijah Steele, Nyla Ahmed, Rahazia Young, Harish Thirunavu</p>
      <p class="hint">==========================</p>
    </div>
  </div>

  <header>
    <h1>Taj India Timeline (1986â€“Present)</h1>
  </header>

  <main class="container">
    <!-- Dot navigation -->
    <section class="timeline-nav" aria-label="Timeline navigation">
      <div class="rail">
        <button class="dot" data-key="1986"          aria-label="1986"               data-label="1986"></button>
        <button class="dot" data-key="1990s-2000s"   aria-label="Late 1990sâ€“2000s"   data-label="Late 1990sâ€“2000s"></button>
        <button class="dot" data-key="1994"          aria-label="July 20, 1994"      data-label="July 20, 1994"></button>
        <button class="dot" data-key="2003"          aria-label="Jan 23, 2003"       data-label="Jan 23, 2003"></button>
        <button class="dot" data-key="2012"          aria-label="Nov 14, 2012"       data-label="Nov 14, 2012"></button>
        <button class="dot" data-key="2020covid"     aria-label="Mar 13, 2020"       data-label="Mar 13, 2020"></button>
        <button class="dot" data-key="2020lease"     aria-label="Jun 21, 2020"       data-label="Jun 21, 2020"></button>
        <button class="dot" data-key="2023demo"      aria-label="Nov 2023"           data-label="Nov 2023"></button>
        <button class="dot" data-key="2024"          aria-label="2024"               data-label="2024"></button>
        <button class="dot" data-key="2025award"     aria-label="Oct 2025"           data-label="Oct 2025"></button>
      </div>
    </section>

    <!-- Single viewer card -->
    <section id="viewer" aria-live="polite">
      <div class="viewer-date"></div>
      <div class="viewer-card">
        <div class="viewer-media">
          <button class="viewer-nav viewer-nav-prev" type="button" aria-label="Previous image">â€¹</button>
          <img class="viewer-img" src="images/test1.jpg" alt="Timeline image" />
          <button class="viewer-nav viewer-nav-next" type="button" aria-label="Next image">â€º</button>
        </div>

        <div class="text-block">
          <h2 class="viewer-title">Select a date above</h2>
          <p class="viewer-desc">Click any dot to load that moment in the Taj India story.</p>
        </div>
      </div>
    </section>


    <!-- Hidden full timeline list (kept for content loading) -->
    <section class="timeline" aria-hidden="true">
      <div class="event">
        <div class="date">1986</div>
        <div class="content" data-desc="./dates/1986.txt">
          <img src="images/test1.png" alt="Taj India logo icon">
          <div class="text-block">
            <h2>Royal Taj opens, introducing Indian cuisine to Birmingham</h2>
            <p class="desc"></p>
          </div>
        </div>
      </div>
      <div class="event">
        <div class="date">July 20, 1994</div>
        <div class="content" data-desc="./dates/1994.txt">
          <div class="text-block">
            <h2>Taj India opens on Highland Ave with $5.95 buffet</h2>
            <p class="desc"></p>
          </div>
        </div>
      </div>
      <div class="event">
        <div class="date">November 14, 2012</div>
        <div class="content" data-desc="./dates/2012.txt">
          <div class="text-block">
            <h2>First Holi Facebook post builds digital connection</h2>
            <p class="desc"></p>
          </div>
        </div>
      </div>
      <div class="event">
        <div class="date">Summer 2019</div>
        <div class="content" data-desc="./dates/2019.txt">
          <div class="text-block">
            <h2>25th Anniversary and reflections on Highland Plazaâ€™s future</h2>
            <p class="desc"></p>
          </div>
        </div>
      </div>
      <div class="event">
        <div class="date">March 13, 2020</div>
        <div class="content" data-desc="./dates/2020-covid.txt">
          <div class="text-block">
            <h2>COVID safety post highlights health and community care</h2>
            <p class="desc"></p>
          </div>
        </div>
      </div>
      <div class="event">
        <div class="date">June 21, 2020</div>
        <div class="content" data-desc="./dates/2020-lease.txt">
          <div class="text-block">
            <h2>Lease extension confirms stability during uncertainty</h2>
            <p class="desc"></p>
          </div>
        </div>
      </div>
      <div class="event">
        <div class="date">July 5, 2023</div>
        <div class="content" data-desc="./dates/2023-redev.txt">
          <div class="text-block">
            <h2>Redevelopment forces relocation decision</h2>
            <p class="desc"></p>
          </div>
        </div>
      </div>
      <div class="event">
        <div class="date">Summer 2023</div>
        <div class="content" data-desc="./dates/2023-relocate.txt">
          <div class="text-block">
            <h2>Relocation to historic Fire Station No. 22 begins</h2>
            <p class="desc"></p>
          </div>
        </div>
      </div>
      <div class="event">
        <div class="date">November 2023</div>
        <div class="content" data-desc="./dates/2023-demo.txt">
          <div class="text-block">
            <h2>Demolition of Highland Plaza marks end of an era</h2>
            <p class="desc"></p>
          </div>
        </div>
      </div>
      <div class="event">
        <div class="date">October 2025</div>
        <div class="content" data-desc="./dates/2025-award.txt">
          <div class="text-block">
            <h2>National recognition â€” Taj India named Alabamaâ€™s top Indian restaurant</h2>
            <p class="desc"></p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Decorative frame just above footer -->
  <div class="decor-frame bottom" aria-hidden="true"></div>

  <!-- Single pair of steam wisps (avoid duplicates) -->
  <div class="steam left" aria-hidden="true"></div>
  <div class="steam right" aria-hidden="true"></div>

  <!-- Diya -->
  <div class="diyaa" aria-hidden="true">ðŸª”</div>

  <!-- Footer -->
  <footer>
    <p>Â© 2025 Taj India Timeline Project</p>
  </footer>

  <!-- Particles canvas (present BEFORE the script runs) -->
  <canvas id="particles" aria-hidden="true"></canvas>
  <!-- Image lightbox -->
  <div id="lightbox" class="lightbox" aria-hidden="true">
    <div class="lightbox-backdrop"></div>
    <div class="lightbox-content" role="dialog" aria-modal="true">
      <button class="lightbox-close" type="button" aria-label="Close image viewer">Ã—</button>

      <button class="lightbox-nav lightbox-prev" type="button" aria-label="Previous image">â€¹</button>
      <img class="lightbox-img" src="" alt="" />
      <button class="lightbox-nav lightbox-next" type="button" aria-label="Next image">â€º</button>
    </div>
  </div>
  <script>
    // Fade in when entering view; reset when leaving
    const observer = new IntersectionObserver((entries) => {
      entries.forEach((e) => {
        if (e.isIntersecting) e.target.classList.add('show');
        else e.target.classList.remove('show');
      });
    }, { threshold: 0.15 });

    document.querySelectorAll('.event').forEach((el) => {
      el.classList.add('reveal');
      observer.observe(el);
    });

    // Load descriptions for hidden timeline cards (source-of-truth for text)
    document.querySelectorAll('.content[data-desc]').forEach(async (card) => {
      const target = card.querySelector('.desc');
      if (!target) return;
      try {
        const res = await fetch(card.getAttribute('data-desc'), { cache: 'no-store' });
        if (!res.ok) throw new Error(res.statusText);
        const text = await res.text();
        target.textContent = text.trim();
      } catch (err) {
        target.textContent = "(Description unavailable)";
        console.error("Failed to load:", card.getAttribute('data-desc'), err);
      }
    });

    // Intro overlay: click anywhere to hide (and keyboard accessible)
    (function(){
      const intro = document.getElementById('intro');
      if(!intro) return;
      const dismiss = () => intro.classList.add('hide');
      intro.addEventListener('click', dismiss);
      intro.tabIndex = 0;
      intro.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') dismiss();
      });
    })();

    // Map dot keys -> text files + images (single slot; some have multiple images)
    const TIMELINE_MAP = {
      "1986": {
        date: "1986",
        title: "Royal Taj opens, introducing Indian cuisine to Birmingham",
        txt: "./dates/1986.txt",
        images: ["images/test1.jpg"]
      },

      "1990s-2000s": {
        date: "Late 1990sâ€“2000s",
        title: "Building a community around Indian cuisine and hospitality",
        txt: "./dates/1990s-2000s.txt",
        images: [
          "images/com_1.jpg",
          "images/com_2.jpg",
          "images/com_3.jpg",
          "images/com_4.jpg"
        ]
      },

      "1994": {
        date: "July 20, 1994",
        title: "Taj India opens on Highland Avenue in the Highland Plaza",
        txt: "./dates/1994.txt",
        images: ["images/building.jpg"]
      },

      "2003": {
        date: "January 23, 2003",
        title: "Early website and menu help Birmingham locals understand Indian cuisine",
        txt: "./dates/2003.txt",
        images: [
          "images/old.png",
          "images/old_2.png",
          "images/old_3.png"
        ]
      },

      "2012": {
        date: "November 14, 2012",
        title: "First Holi Facebook post builds digital connection",
        txt: "./dates/2012.txt",
        images: [
          "images/holi.png",
          "images/holi_2.jpg",
          "images/holi_3.jpg",
          "images/holi_4.jpg"
        ]
      },

      "2020covid": {
        date: "March 13, 2020",
        title: "COVID-19 safety post highlights health and community care",
        txt: "./dates/2020-covid.txt",
        images: ["images/covid.png"]
      },

      "2020lease": {
        date: "June 21, 2020",
        title: "Lease extension Reassures Regulars",
        txt: "./dates/2020-lease.txt",
        images: ["images/indoors.png"]
      },

      // Point 8 â€“ just rotate through all relevant photos in the single slot
      "2023demo": {
        date: "November 2023",
        title: "Demolition of Highland Plaza begins a new chapter",
        txt: "./dates/2023-demo.txt",
        images: [
          "images/fire.png",
          "images/building.jpg",
          "images/new_1.png",
          "images/new_2.png",
          "images/new_3.png"
        ]
      },

      // Point 9 â€“ two images (anniversary + chefs), user cycles between them
      "2024": {
        date: "2024",
        title: "30 years of business and one year at the new Clairmont location",
        txt: "./dates/2024.txt",
        images: [
          "images/years.png",
          "images/chefs.jpg"
        ]
      },

      "2025award": {
        date: "October 2025",
        title: "National recognition:Taj India named Alabamaâ€™s top Indian restaurant",
        txt: "./dates/2025-award.txt",
        images: ["images/award.jpg"]
      }
    };



const dots   = document.querySelectorAll('.timeline-nav .dot');
const card   = document.querySelector('.viewer-card');
const elDate = document.querySelector('.viewer-date');
const elTitle= document.querySelector('.viewer-title');
const elDesc = document.querySelector('.viewer-desc');

const imgEl   = document.querySelector('.viewer-img');
const prevBtn = document.querySelector('.viewer-nav-prev');
const nextBtn = document.querySelector('.viewer-nav-next');
// Lightbox elements
const lightbox   = document.getElementById('lightbox');
const lbImg      = document.querySelector('.lightbox-img');
const lbPrev     = document.querySelector('.lightbox-prev');
const lbNext     = document.querySelector('.lightbox-next');
const lbClose    = document.querySelector('.lightbox-close');
const lbBackdrop = document.querySelector('.lightbox-backdrop');

const viewerState = {
  key: null,
  index: 0
};

function setActive(dot) {
  dots.forEach(d => d.classList.remove('active'));
  dot.classList.add('active');
}

// return array of image URLs for an entry
function getImages(cfg) {
  if (cfg.images && cfg.images.length) return cfg.images;
  return [];
}

function applyImage(cfg) {
  const imgs = getImages(cfg);
  if (!imgs.length) {
    imgEl.style.display = 'none';
    prevBtn.style.display = 'none';
    nextBtn.style.display = 'none';
    return;
  }

  const n = imgs.length;
  viewerState.index = ((viewerState.index % n) + n) % n;

  imgEl.style.display = 'block';
  imgEl.src = imgs[viewerState.index];
  imgEl.alt = cfg.title;

  const showNav = n > 1;
  prevBtn.style.display = showNav ? 'flex' : 'none';
  nextBtn.style.display = showNav ? 'flex' : 'none';
}

async function loadEntry(key) {
  const cfg = TIMELINE_MAP[key];
  if (!cfg) return;

  viewerState.key = key;
  viewerState.index = 0;

  card.classList.remove('fade-in');
  card.classList.add('fade-out');

  try {
    const res = await fetch(cfg.txt, { cache: 'no-store' });
    const text = res.ok ? (await res.text()).trim() : '(Description unavailable)';

    setTimeout(() => {
      elDate.textContent = cfg.date;
      elTitle.textContent = cfg.title;
      elDesc.textContent  = text || '(Description unavailable)';

      applyImage(cfg);

      card.classList.remove('fade-out');
      void card.offsetWidth;
      card.classList.add('fade-in');
    }, 260);
  } catch (e) {
    setTimeout(() => {
      elDate.textContent = cfg.date;
      elTitle.textContent = cfg.title;
      elDesc.textContent  = '(Description unavailable)';

      applyImage(cfg);

      card.classList.remove('fade-out');
      card.classList.add('fade-in');
    }, 260);
  }
}

function updateLightboxImage(cfg) {
  const imgs = getImages(cfg);
  if (!imgs.length) return;

  const n = imgs.length;
  viewerState.index = ((viewerState.index % n) + n) % n;

  lbImg.src = imgs[viewerState.index];
  lbImg.alt = cfg.title;

  const showNav = n > 1;
  lbPrev.style.display = showNav ? 'flex' : 'none';
  lbNext.style.display = showNav ? 'flex' : 'none';
}
// Lightbox opening

function changeImage(delta) {
  if (!viewerState.key) return;
  const cfg = TIMELINE_MAP[viewerState.key];
  if (!cfg) return;

  const imgs = getImages(cfg);
  if (imgs.length <= 1) return;

  const n = imgs.length;
  viewerState.index = (viewerState.index + delta + n) % n;

  applyImage(cfg);
  if (lightbox.classList.contains('show')) {
    updateLightboxImage(cfg);
  }
}

function openLightbox() {
  if (!viewerState.key) return;
  const cfg = TIMELINE_MAP[viewerState.key];
  if (!cfg) return;

  updateLightboxImage(cfg);
  lightbox.classList.add('show');
  lightbox.setAttribute('aria-hidden', 'false');
}

function closeLightbox() {
  lightbox.classList.remove('show');
  lightbox.setAttribute('aria-hidden', 'true');
}

// dot clicks load entries
dots.forEach(dot => {
  dot.addEventListener('click', () => {
    setActive(dot);
    loadEntry(dot.dataset.key);
  });
});

// arrow clicks cycle images when there are multiple
prevBtn.addEventListener('click', () => changeImage(-1));
nextBtn.addEventListener('click', () => changeImage(1));
// Click main image to open lightbox
imgEl.addEventListener('click', openLightbox);

// Lightbox controls
lbPrev.addEventListener('click', () => changeImage(-1));
lbNext.addEventListener('click', () => changeImage(1));
lbClose.addEventListener('click', closeLightbox);
lbBackdrop.addEventListener('click', closeLightbox);

// Close on Escape key
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape' && lightbox.classList.contains('show')) {
    closeLightbox();
  }
});

// Auto-select the first point
const first = document.querySelector('.timeline-nav .dot');
if (first) { first.click(); }


    // Particles â€” ensure canvas exists before using it
    document.addEventListener('DOMContentLoaded', () => {
      const canvas = document.getElementById("particles");
      if (!canvas) return;
      const ctx = canvas.getContext("2d");
      let particles = [];
      const particleCount = 60;

      function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      window.addEventListener("resize", resizeCanvas);
      resizeCanvas();

      function createParticle() {
        const side = Math.random() > 0.5 ? 'left' : 'right';
        const x = side === 'left'
          ? Math.random() * 200
          : canvas.width - Math.random() * 200;
        const y = canvas.height + 20;
        const size = Math.random() * 4 + 2;
        const speedY = Math.random() * 0.5 + 0.4;
        const opacity = Math.random() * 0.5 + 0.5;
        return { x, y, size, speedY, opacity };
      }

      function drawParticles() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let p of particles) {
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
          ctx.fillStyle = `rgba(255, 204, 102, ${p.opacity})`;
          ctx.fill();
          p.y -= p.speedY;
          p.x += Math.sin(p.y * 0.02) * 0.3;
          p.opacity -= 0.0008;
        }
        particles = particles.filter(p => p.opacity > 0);
      }

      function loop() {
        if (particles.length < particleCount) {
          particles.push(createParticle());
        }
        drawParticles();
        requestAnimationFrame(loop);
      }
      loop();
    });
  </script>
</body>
</html>
